---
layout: post
title: Creating Custom Constraints
categories:
- constraints
- grails
tags: []
status: publish
type: post
published: true
meta:
  _flattr_post_language: ''
  _flattr_post_category: ''
  _flattr_post_hidden: ''
  _flattr_btn_disabled: ''
  blogger_blog: grails-inside.blogspot.com
  blogger_author: Andre Steingress
  blogger_d263388631120bb7ee0fc300fe57c4e6_permalink: '1234872055434750990'
  reddit: s:55:"a:2:{s:5:"count";s:1:"0";s:4:"time";s:10:"1293719811";}";
  _edit_lock: '1294152263'
---
Now and than there is the requirement to create <em>custom constraints</em>. As you might already know, there are plenty of constraints that already are shipped with Grails. Those can be applied in the constraints closure of your domain or command classes:<br /><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">class User &nbsp;{</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">String firstName</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">String surName</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">Short &nbsp;age</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">static constraints = {</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">firstName(blank: false, maxSize: 150)</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">surName(blank: false, maxSize: 150)</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">age(min: 18 as Short, max: 99 as Short)</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">}</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">}</span><br /><br />In order to implement custom constraints like i.e. an age constraint, which encapsulates the constraint's implementation you could extend from Grail's <span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">AbstractConstraint</span><span style="font-size:13pt;"> </span>class. The problem with this approach is, that you than need to register your custom constraint at bootstrap, to use it in every possible scenario (going from testing to running the app).<br /><br />Fortunately there is a plugin that helps with creating custom constraints: the <span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">constraints</span> plugin.<br /><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">grails install-plugin constraints</span><br /><br />Installs the plugin and adds a dependency entry in your application or plugin settings. If installation was successful your <span style="font-size:13pt;"><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size:medium;">grails help</span></span> </span>command lists the <span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">create-constraint</span> command, that from now can be used to create custom constraints.<br /><br /><br />Creating an application-specific age constraint would be as simple as:<br /><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">grails create-constraint Age</span><br /><br />which creates <span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">grails-app/utils/AgeConstraint</span> which i modified to be<br /><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">class AgeConstraint {</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">def validate = { propertyValue -&gt;</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">return propertyValue &gt;= 18 &amp;&amp; propertyValue &lt;= 99</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">}</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">}</span><br /><br /><br />After declaring the constraint it can be used in domain or command classes:<br /><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">class User &nbsp;{</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">String firstName</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">String surName</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">Short &nbsp;age</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;"><br /></span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">static constraints = {</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">firstName(blank: false, maxSize: 150)</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">surName(blank: false, maxSize: 150)</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">age(age: true)</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">&nbsp;&nbsp; </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">}</span><br /><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">}</span><br /><br />If you take a look at the <span style="text-decoration:underline;"><a href="http://github.com/geofflane/grails-constraints">plugin's documentation</a></span> [0] there are several to use default message codes for i18n of error messages and so on. But this plugin works perfectly for adding custom constraints to your Grails environment.<br /><br /><br />[0] Constraints Plugin -&nbsp;<span style="text-decoration:underline;"><a href="http://github.com/geofflane/grails-constraints">http://github.com/geofflane/grails-constraints</a></span>
